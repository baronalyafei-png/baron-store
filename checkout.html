<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø´Ø±Ø§Ø¡ - Baron</title>

<style>
body{
    background:#0A0A0A;
    color:#EFEFEF;
    font-family:Arial;
    margin:0;
    padding:20px;
}

h1{
    text-align:center;
    margin-bottom:40px;
}

.container{
    max-width:600px;
    margin:0 auto;
    background:#111;
    padding:30px;
    border-radius:15px;
    box-shadow:0 0 20px rgba(181,60,184,0.3);
}

input, textarea{
    width:100%;
    padding:10px;
    margin:10px 0;
    border:none;
    border-radius:8px;
}

button{
    width:100%;
    padding:12px;
    background:#B53CB8;
    border:none;
    color:white;
    border-radius:8px;
    cursor:pointer;
    font-size:16px;
}

button:hover{
    opacity:0.9;
}

.total{
    margin-top:20px;
    font-size:18px;
    color:#B53CB8;
}
</style>

</head>

<body>

<h1>Ø¥ØªÙ…Ø§Ù… Ø§Ù„Ø´Ø±Ø§Ø¡ ðŸ’³</h1>

<div class="container">

<input type="text" id="customerName" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
<input type="text" id="customerPhone" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
<textarea id="customerAddress" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†"></textarea>

<div class="total" id="totalPrice"></div>

<button onclick="submitOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨</button>

</div>

<script type="module">

import { db } from "./firebase-config.js";
import { collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

let cart = JSON.parse(localStorage.getItem("cart")) || [];

let total = 0;
cart.forEach(item => total += item.price);

document.getElementById("totalPrice").innerText = "Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: " + total + " Ø¯.Ù„";

window.submitOrder = async function(){

    const name = document.getElementById("customerName").value;
    const phone = document.getElementById("customerPhone").value;
    const address = document.getElementById("customerAddress").value;

    if(!name || !phone || !address){
        alert("ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª");
        return;
    }

    try{
        await addDoc(collection(db, "orders"), {
            customerName: name,
            customerPhone: phone,
            customerAddress: address,
            items: cart,
            total: total,
            status: "Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯",
            createdAt: new Date()
        });

        alert("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ù†Ø¬Ø§Ø­ ðŸ‘‘");

        localStorage.removeItem("cart");

        window.location.href = "store.html";

    }catch(error){
        console.error(error);
        alert("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨");
    }

}

</script>

</body>
</html>
